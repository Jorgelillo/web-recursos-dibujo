---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import { Image } from 'astro:assets';

export async function getStaticPaths() {
  const tareas = await getCollection('tareas');
  return tareas.map(entry => ({
    params: { slug: entry.slug },
    props: { tarea: entry },
  }));
}

const { tarea } = Astro.props;
const { Content } = await tarea.render(); // Renderiza el Markdown
---

<Layout title={tarea.data.titulo}>
  <article class="container mx-auto p-4 max-w-4xl">
    <a href={`/asignaturas/${tarea.data.asignatura}`} class="text-blue-500 mb-4 block">â† Volver a la asignatura</a>
    
    <h1 class="text-4xl font-bold mb-2">{tarea.data.titulo}</h1>
    <div class="flex gap-2 text-sm text-gray-600 mb-8">
        <span>ğŸ“… {tarea.data.fecha.toLocaleDateString()}</span>
        <span>ğŸ¨ {tarea.data.tecnica}</span>
    </div>

    <div class="prose prose-lg max-w-none mb-12">
        <Content />
    </div>

    {tarea.data.ejemplosAlumnos && (
        <section class="border-t pt-8">
            <h2 class="text-2xl font-bold mb-6">Trabajos de Alumnos</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                {tarea.data.ejemplosAlumnos.map((imgAlumno, index) => (
                    <figure>
                      <!--   <Image 
                            src={imgAlumno} 
                            alt={`Ejemplo de alumno ${index + 1}`} 
                            class="rounded-lg shadow-md hover:scale-105 transition duration-300"
                        />
                        -->
                    </figure>
                ))}
            </div>
        </section>
    )}
  </article>
</Layout>